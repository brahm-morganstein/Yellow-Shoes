const trapFocusHandlers={};function removeTrapFocus(e=null){document.removeEventListener("focusin",trapFocusHandlers.focusin),document.removeEventListener("focusout",trapFocusHandlers.focusout),document.removeEventListener("keydown",trapFocusHandlers.keydown),e&&e.focus()}function trapFocus(e,t=e){const o=Array.from(e.querySelectorAll('summary, a[href], area[href], button:not([disabled]), input:not([type=hidden]):not([disabled]), select:not([disabled]), textarea:not([disabled]), object, iframe, audio[controls], video[controls], [tabindex]:not([tabindex^="-"])')),s=o[0],n=o[o.length-1];removeTrapFocus(),trapFocusHandlers.focusin=t=>{t.target!==e&&t.target!==n&&t.target!==s||document.addEventListener("keydown",trapFocusHandlers.keydown)},trapFocusHandlers.focusout=()=>{document.removeEventListener("keydown",trapFocusHandlers.keydown)},trapFocusHandlers.keydown=t=>{"Tab"===t.code&&(t.target!==n||t.shiftKey||(t.preventDefault(),s.focus()),t.target!==e&&t.target!==s||!t.shiftKey||(t.preventDefault(),n.focus()))},document.addEventListener("focusout",trapFocusHandlers.focusout),document.addEventListener("focusin",trapFocusHandlers.focusin),(t||e).focus()}class Modal extends HTMLElement{constructor(){super(),this.addEventListener("click",this.handleClick.bind(this))}handleClick(e){(e.target===this||e.target.matches(".js-close-modal"))&&this.close()}open(e){this.scrollY=window.scrollY,document.body.classList.add("fixed"),document.body.style.top=`-${this.scrollY}px`,this.setAttribute("open",""),this.openedBy=e,trapFocus(this),window.pauseAllMedia(),this.keyupHandler=e=>"Escape"===e.key&&this.close(),this.addEventListener("keyup",this.keyupHandler),this.querySelectorAll("table").forEach((e=>{const t=document.createElement("div");t.className="scrollable-table",e.parentNode.insertBefore(t,e),t.appendChild(e)}))}close(){document.body.style.top="",document.body.classList.remove("fixed"),window.scrollTo(0,this.scrollY),this.removeAttribute("open"),removeTrapFocus(this.openedBy),window.pauseAllMedia(),this.removeEventListener("keyup",this.keyupHandler)}}customElements.define("modal-dialog",Modal);