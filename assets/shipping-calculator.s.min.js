if(!customElements.get("shipping-calculator")){class t extends HTMLElement{constructor(){super(),this.zip=this.querySelector(".js-zip-input"),this.zip.addEventListener("keydown",this.handleZipKeydown.bind(this)),this.button=this.querySelector("button"),this.button.addEventListener("click",this.handleSubmit.bind(this))}init(){this.country=this.querySelector(".js-country-select"),this.province=this.querySelector(".js-province-select"),this.rates=this.querySelector(".js-rates"),this.errors=this.querySelector(".js-errors"),this.initialised=!0}async handleSubmit(t){t.preventDefault(),this.initialised||this.init(),this.errors.hidden=!0,this.rates.hidden=!0,this.button.disabled=!0,this.button.classList.add("is-loading");const e=`shipping_address[zip]=${this.zip.value}&shipping_address[country]=${this.country.value}&shipping_address[province]=${this.province.value}`;try{const t=await fetch(`${theme.routes.cart}/shipping_rates.json?${e}`),s=await t.json();t.ok?this.showRates(s):this.showErrors(s)}catch(t){console.log(t)}finally{this.button.classList.remove("is-loading"),this.button.disabled=!1}}handleZipKeydown(t){"Enter"===t.key&&(t.preventDefault(),this.handleSubmit(t))}showRates(t){const e=this.rates.querySelector(".js-rates-heading"),s=this.rates.querySelector(".js-rates-text");if(s.innerHTML="",t.shipping_rates&&t.shipping_rates.length){const i=1===t.shipping_rates.length?"singleRate":"multipleRates";let r="";t.shipping_rates.forEach((t=>{const e=theme.settings.moneyWithCurrencyFormat.replace(/\{\{\s*(\w+)\s*\}\}/,t.price);r+=`<li>${t.name}: ${e}</li>`})),e.hidden=!1,e.textContent=theme.strings.shippingCalculator[i],s.innerHTML=`<ul class="styled-list">${r}</ul>`}else e.hidden=!0,s.innerHTML=theme.strings.shippingCalculator.noRates;this.rates.hidden=!1}showErrors(t){let e="";Object.keys(t).forEach((s=>{e+=`<li>${t[s]}</li>`})),this.errors.querySelector(".js-errors-text").innerHTML=`<ul class="styled-list">${e}</ul>`,this.errors.hidden=!1}}customElements.define("shipping-calculator",t)}