function debounce(t,e=300){let s;return(...i)=>{clearTimeout(s),s=setTimeout((()=>t.apply(this,i)),e)}}class CarouselSlider extends HTMLElement{constructor(){super(),this.slides=[...this.querySelectorAll(".slider__item:not([hidden])")],this.slides.length<2?this.setCarouselState(!1):window.initLazyScript(this,this.init.bind(this))}init(){this.slider=this.querySelector(".slider"),this.grid=this.querySelector(".slider__grid"),this.nav=this.querySelector(".slider-nav"),this.rtl="rtl"===document.dir,this.nav&&(this.prevBtn=this.querySelector('button[name="prev"]'),this.nextBtn=this.querySelector('button[name="next"]')),this.initSlider(),window.addEventListener("on:debounced-resize",this.handleResize.bind(this)),this.setAttribute("loaded","")}initSlider(){this.gridWidth=this.grid.clientWidth,this.slideSpan=this.getWindowOffset(this.slides[1])-this.getWindowOffset(this.slides[0]),this.currentIndex=Math.round(this.slider.scrollLeft/this.slideSpan)||0,this.slideGap=this.slideSpan-this.slides[0].clientWidth,this.slidesPerPage=Math.round((this.gridWidth+this.slideGap)/this.slideSpan),this.slidesToScroll="page"===theme.settings.sliderItemsPerNav?this.slidesPerPage:1,this.totalPages=this.slides.length-this.slidesPerPage+1,this.setCarouselState(this.totalPages>1),"true"===this.dataset.dynamicHeight&&this.updateDynamicHeight(),this.addListeners(),this.totalPages<2||!this.nav||(this.sliderStart=this.getWindowOffset(this.slider),this.sliderStart||(this.sliderStart=(this.slider.clientWidth-this.gridWidth)/2),this.sliderEnd=this.sliderStart+this.gridWidth,window.matchMedia("(pointer: fine)").matches&&this.slider.classList.add("is-grabbable"),this.setButtonStates())}refresh(){this.hasAttribute("loaded")&&(this.removeListeners(),this.style.removeProperty("--current-slide-height")),this.slides=[...this.querySelectorAll(".slider__item:not([hidden])")],this.slides.length<2?this.setCarouselState(!1):this.init()}addListeners(){this.scrollHandler=debounce(this.handleScroll.bind(this),100),this.slider.addEventListener("scroll",this.scrollHandler),this.nav&&(this.navClickHandler=this.handleNavClick.bind(this),this.nav.addEventListener("click",this.navClickHandler)),window.matchMedia("(pointer: fine)").matches&&(this.mousedownHandler=this.handleMousedown.bind(this),this.mouseupHandler=this.handleMouseup.bind(this),this.mousemoveHandler=this.handleMousemove.bind(this),this.slider.addEventListener("mousedown",this.mousedownHandler),this.slider.addEventListener("mouseup",this.mouseupHandler),this.slider.addEventListener("mouseleave",this.mouseupHandler),this.slider.addEventListener("mousemove",this.mousemoveHandler))}removeListeners(){this.slider.removeEventListener("scroll",this.scrollHandler),this.nav&&this.nav.removeEventListener("click",this.navClickHandler),window.matchMedia("(pointer: fine)").matches&&(this.slider.removeEventListener("mousedown",this.mousedownHandler),this.slider.removeEventListener("mouseup",this.mouseupHandler),this.slider.removeEventListener("mouseleave",this.mouseupHandler),this.slider.removeEventListener("mousemove",this.mousemoveHandler))}handleScroll(){const t=this.currentIndex;this.currentIndex=Math.round(Math.abs(this.slider.scrollLeft)/this.slideSpan),this.nav&&this.setButtonStates(),"true"===this.dataset.dynamicHeight&&this.updateDynamicHeight(),"true"===this.dataset.dispatchEvents&&t!==this.currentIndex&&this.dispatchEvent(new CustomEvent("on:carousel-slider:select",{bubbles:!0,detail:{index:this.currentIndex,slide:this.slides[this.currentIndex]}}))}handleMousedown(t){this.mousedown=!0,this.startX=t.pageX-this.sliderStart,this.scrollPos=this.slider.scrollLeft,this.slider.classList.add("is-grabbing")}handleMouseup(){this.mousedown=!1,this.slider.classList.remove("is-grabbing")}handleMousemove(t){if(!this.mousedown)return;t.preventDefault();const e=t.pageX-this.sliderStart;this.slider.scrollLeft=this.scrollPos-2*(e-this.startX)}handleNavClick(t){t.target.matches(".slider-nav__btn")&&("next"===t.target.name&&!this.rtl||"prev"===t.target.name&&this.rtl?this.scrollPos=this.slider.scrollLeft+this.slidesToScroll*this.slideSpan:this.scrollPos=this.slider.scrollLeft-this.slidesToScroll*this.slideSpan,this.slider.scrollTo({left:this.scrollPos,behavior:"smooth"}),console.log(123))}handleResize(){this.nav&&this.removeListeners(),this.initSlider()}scrollToElement(t,e){this.getSlideVisibility(t)||(this.scrollPos=t.offsetLeft,this.slider.scrollTo({left:this.scrollPos,behavior:e||"smooth"}))}updateDynamicHeight(){this.style.setProperty("--current-slide-height",`${this.slides[this.currentIndex].firstElementChild.clientHeight}px`)}getWindowOffset(t){return this.rtl?window.innerWidth-t.getBoundingClientRect().right:t.getBoundingClientRect().left}getSlideVisibility(t){const e=this.getWindowOffset(t),s=Math.floor(e+this.slides[0].clientWidth);return e>=this.sliderStart&&s<=this.sliderEnd}setCarouselState(t){t?(this.removeAttribute("inactive"),this.gridWidth!==this.grid.clientWidth&&this.handleBreakpointChange()):this.setAttribute("inactive","")}setButtonStates(){this.prevBtn.disabled=this.getSlideVisibility(this.slides[0])&&0===this.slider.scrollLeft,this.nextBtn.disabled=this.getSlideVisibility(this.slides[this.slides.length-1])}}customElements.define("carousel-slider",CarouselSlider);